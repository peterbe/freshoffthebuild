{"version":3,"sources":["App.js","serviceWorker.js","index.js"],"names":["DEFAULT_SOURCE","process","REACT_APP_DEFAULT_SOURCE","DEFAULT_FREQUENCY","parseInt","REACT_APP_DEFAULT_FREQUENCY","DEFAULT_FREQUENCY_UNIT","REACT_APP_DEFAULT_FREQUENCY_UNIT","searchParams","URLSearchParams","window","location","search","defaultSource","get","URL","ex","msg","concat","toString","alert","Error","defaultFrequency","defaultFrequencyUnit","App","state","source","frequency","frequencyUnit","loading","result","lookups","serverError","getSeconds","seconds","_this","loop","_callee","regenerator_default","a","wrap","_context","prev","next","dismounted","abrupt","fetch","setState","start","Date","getTime","setTimeout","stop","this","_callee2","url","response","json","_context2","aggs","products","filter","match_all","source.product","terms","field","size","source.product_count","cardinality","sort","download.date","highlight","fields","target.channel","target.version","target.locale","target.platform","build.id","ky","post","href","sent","ok","t0","console","warn","_this2","react_default","createElement","className","ShowServerError","error","App_ShowAggregates","aggregates","aggregations","App_ShowProgressBar","ShowLookups","style","textAlign","onClick","_ref3","Object","asyncToGenerator","mark","_callee4","event","_context4","preventDefault","_x","apply","arguments","action","type","name","defaultValue","placeholder","DisplayVersion","Component","React","memo","element","document","querySelector","data","assign","dataset","target","rel","commit","title","date","slice","_ref4","isResponseError","Response","status","_ref5","toLocaleString","ShowProgressBar","secondsLeft","percentage","_this3$props","_this3","props","total","done","Math","ceil","width","id","hours","trunc","minutes","showSecondsHuman","PureComponent","ShowAggregates","previous","_this4","initial","prevProps","nanoEqual","packageProducts","buckets","map","bucket","key","count","doc_count","previousProducts","initialProducts","topMargin","innerHeight","margin","ShowProducts","extraClassname","_ref6","_ref6$extraClassname","product","Boolean","hostname","match","ReactDOM","render","src_App_0","getElementById","navigator","serviceWorker","ready","then","registration","unregister"],"mappings":"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","file":"static/js/main.9ec267fe.chunk.js","sourcesContent":["import React, { Component } from \"react\";\nimport ky from \"ky\";\nimport nanoEqual from \"nano-equal\";\nimport \"./App.scss\";\n\nconst DEFAULT_SOURCE =\n  process.env.REACT_APP_DEFAULT_SOURCE || \"https://buildhub2.stage.mozaws.net/\";\nconst DEFAULT_FREQUENCY = parseInt(\n  process.env.REACT_APP_DEFAULT_FREQUENCY || 60,\n  10\n);\nconst DEFAULT_FREQUENCY_UNIT =\n  process.env.REACT_APP_DEFAULT_FREQUENCY_UNIT || \"seconds\";\n\nconst searchParams = new URLSearchParams(window.location.search);\nconst defaultSource = searchParams.get(\"s\") || DEFAULT_SOURCE;\ntry {\n  new URL(defaultSource);\n} catch (ex) {\n  const msg = `The URL parameter is not valid! Try harder. (${ex.toString()})`;\n  alert(msg);\n  throw new Error(msg);\n}\nconst defaultFrequency = parseInt(\n  searchParams.get(\"f\") || DEFAULT_FREQUENCY,\n  10\n);\nconst defaultFrequencyUnit = searchParams.get(\"u\") || DEFAULT_FREQUENCY_UNIT;\n\nclass App extends Component {\n  state = {\n    source: defaultSource,\n    frequency: defaultFrequency,\n    frequencyUnit: defaultFrequencyUnit,\n    loading: true,\n    result: null,\n    lookups: 0,\n    serverError: null\n  };\n  async componentDidMount() {\n    this.loop();\n  }\n\n  componentWillUnmount() {\n    this.dismounted = true;\n  }\n\n  getSeconds = () => {\n    let seconds = this.state.frequency;\n    if (this.state.frequencyUnit === \"minutes\") {\n      seconds *= 60;\n    } else if (this.state.frequencyUnit === \"hours\") {\n      seconds *= 60 * 60;\n    }\n    return seconds;\n  };\n\n  loop = async () => {\n    if (this.dismounted) return;\n    await this.fetch();\n    const seconds = this.getSeconds();\n    this.setState({ start: new Date().getTime() });\n    window.setTimeout(this.loop, seconds * 1000);\n  };\n\n  fetch = async () => {\n    const url = new URL(\"/api/search\", this.state.source);\n\n    const search = {\n      aggs: {\n        products: {\n          filter: { match_all: {} },\n          aggs: {\n            \"source.product\": { terms: { field: \"source.product\", size: 50 } },\n            \"source.product_count\": { cardinality: { field: \"source.product\" } }\n          }\n        }\n      },\n      size: 0,\n      sort: [{ \"download.date\": \"desc\" }],\n      highlight: {\n        fields: {\n          \"source.product\": {},\n          \"target.channel\": {},\n          \"target.version\": {},\n          \"target.locale\": {},\n          \"target.platform\": {},\n          \"build.id\": {}\n        }\n      }\n    };\n    try {\n      const response = await ky.post(url.href, { json: search });\n      if (response.ok) {\n        const json = await response.json();\n        this.setState({\n          result: json,\n          lookups: this.state.lookups + 1,\n          serverError: null\n        });\n      } else {\n        this.setState({\n          serverError: response,\n          lookups: this.state.lookups + 1\n        });\n      }\n    } catch (ex) {\n      console.warn(\"EXCEPTION:\", ex);\n      this.setState({\n        serverError: ex,\n        lookups: this.state.lookups + 1\n      });\n    }\n  };\n\n  render() {\n    return (\n      <div>\n        <section className=\"section\">\n          <div className=\"container\">\n            <header className=\"header\">\n              <h1 className=\"title is-3\">Fresh Off The Build</h1>\n              <p className=\"subtitle is-6\">\n                What's Most Recently Built in Mozilla TaskCluster.\n                <br />\n                Basically, keeping an eye on fresh data in Buildhub.\n              </p>\n            </header>\n            {this.state.serverError && (\n              <ShowServerError error={this.state.serverError} />\n            )}\n\n            {this.state.result && (\n              <ShowAggregates aggregates={this.state.result.aggregations} />\n            )}\n\n            {this.state.start && (\n              <ShowProgressBar\n                seconds={this.getSeconds()}\n                start={this.state.start}\n              />\n            )}\n\n            {this.state.lookups > 0 ? (\n              <ShowLookups lookups={this.state.lookups} />\n            ) : (\n              <p style={{ textAlign: \"center\" }}>\n                <i>Lookups haven't start yet.</i>\n              </p>\n            )}\n            {this.state.start && (\n              <button\n                className=\"button is-small\"\n                onClick={async event => {\n                  event.preventDefault();\n                  this.setState({ start: new Date().getTime() });\n                  await this.fetch();\n                }}\n              >\n                Force Refresh Now\n              </button>\n            )}\n            <hr />\n            <form action=\".\">\n              <div className=\"field is-horizontal\">\n                <div className=\"field-label is-normal\">\n                  <label className=\"label\">Source</label>\n                </div>\n                <div className=\"field-body\">\n                  <div className=\"field\">\n                    <div className=\"control\">\n                      <input\n                        className=\"input\"\n                        type=\"url\"\n                        name=\"s\"\n                        defaultValue={this.state.source}\n                        placeholder={`Source URL e.g. ${DEFAULT_SOURCE}`}\n                      />\n                    </div>\n                  </div>\n                </div>\n              </div>\n\n              <div className=\"field is-horizontal\">\n                <div className=\"field-label is-normal\">\n                  <label className=\"label\">Update Frequency</label>\n                </div>\n\n                <div className=\"field-body\">\n                  <div className=\"field\">\n                    <div className=\"field has-addons\">\n                      <div className=\"control\">\n                        <input\n                          className=\"input\"\n                          type=\"number\"\n                          name=\"f\"\n                          defaultValue={this.state.frequency}\n                          placeholder={`Number of seconds between checks. E.g. ${DEFAULT_FREQUENCY}`}\n                        />{\" \"}\n                      </div>\n                      <p className=\"control\">\n                        <span className=\"select\">\n                          <select\n                            name=\"u\"\n                            defaultValue={this.state.frequencyUnit}\n                          >\n                            <option>seconds</option>\n                            <option>minutes</option>\n                            <option>hours</option>\n                          </select>\n                        </span>\n                      </p>\n                    </div>\n                  </div>\n                </div>\n              </div>\n              <div className=\"field is-horizontal\">\n                <div className=\"field-label\">\n                  {/* Left empty for spacing  */}\n                </div>\n                <div className=\"field-body\">\n                  <div className=\"control\">\n                    <button className=\"button is-primary\">\n                      Change Options\n                    </button>\n                  </div>\n                </div>\n              </div>\n            </form>\n          </div>\n        </section>\n        <footer className=\"footer\">\n          <div className=\"content has-text-centered is-small\">\n            <DisplayVersion />\n          </div>\n        </footer>\n      </div>\n    );\n  }\n}\n\nexport default App;\n\nconst DisplayVersion = React.memo(() => {\n  const element = document.querySelector(\"#_version\");\n  const data = Object.assign({}, element.dataset);\n  return (\n    <p className=\"version-info\">\n      <a\n        href=\"https://github.com/peterbe/chiveproxy\"\n        target=\"_blank\"\n        rel=\"noopener noreferrer\"\n      >\n        FreshOffTheBuild\n      </a>\n      <br />\n      Version{\" \"}\n      <a\n        href={`https://github.com/peterbe/freshoffthebuild/commit/${\n          data.commit\n        }`}\n        title={data.date}\n      >\n        {data.commit.slice(0, 7)}\n      </a>{\" \"}\n      {data.date}\n    </p>\n  );\n});\n\nfunction ShowServerError({ error }) {\n  const isResponseError = error instanceof window.Response;\n  return (\n    <article className=\"message is-danger\">\n      <div className=\"message-header\">\n        <p>{isResponseError ? \"Server Error\" : \"Network Error\"}</p>\n      </div>\n      <div className=\"message-body\">\n        {isResponseError ? (\n          <p>\n            <b>{error.status}</b> on <b>{error.url}</b>\n          </p>\n        ) : (\n          <code>{error.toString()}</code>\n        )}\n      </div>\n    </article>\n  );\n}\n\nfunction ShowLookups({ lookups }) {\n  return (\n    <p>\n      <small>\n        Number of lookups made: <b>{lookups.toLocaleString()}</b>\n      </small>\n    </p>\n  );\n}\n\nclass ShowProgressBar extends React.PureComponent {\n  state = {\n    secondsLeft: 0,\n    percentage: 0\n  };\n\n  componentDidMount() {\n    this.loop();\n  }\n\n  loop = () => {\n    const { start, seconds } = this.props;\n    const finish = start + seconds * 1000;\n    const total = finish - start;\n    const now = new Date().getTime();\n    const done = now - start;\n    const secondsLeft = Math.ceil((total - done) / 1000);\n    const percentage = Math.ceil((100 * done) / total);\n    this.setState({ secondsLeft, percentage });\n    window.setTimeout(this.loop, 1000);\n  };\n\n  componentDidUpdate() {\n    const element = document.querySelector(\"#progress\");\n    element.style.width = `${this.state.percentage}%`;\n  }\n\n  render() {\n    const { secondsLeft } = this.state;\n    return (\n      <div>\n        <div id=\"progress\">\n          <b />\n          <i />\n        </div>\n        <small>\n          Time until next check: <b>{showSecondsHuman(secondsLeft)}</b>\n        </small>\n      </div>\n    );\n  }\n}\n\nfunction showSecondsHuman(seconds) {\n  if (seconds > 3600) {\n    const hours = Math.trunc(seconds / 3600);\n    return `${hours} ${hours === 1 ? \"hour\" : \"hours\"}`;\n  } else if (seconds > 60) {\n    const minutes = Math.trunc(seconds / 60);\n    return `${minutes} ${minutes === 1 ? \"minute\" : \"minutes\"}`;\n  } else {\n    return `${seconds} ${seconds === 1 ? \"second\" : \"seconds\"}`;\n  }\n}\n\nclass ShowAggregates extends React.PureComponent {\n  state = { previous: this.props.aggregates, initial: this.props.aggregates };\n\n  componentDidUpdate(prevProps) {\n    if (!nanoEqual(prevProps.aggregates, this.props.aggregates)) {\n      this.setState({ previous: prevProps.aggregates });\n    }\n  }\n  render() {\n    const { aggregates } = this.props;\n    function packageProducts(aggs) {\n      return aggs.products[\"source.product\"].buckets.map(bucket => {\n        return { name: bucket.key, count: bucket.doc_count };\n      });\n    }\n    const products = packageProducts(aggregates);\n    let previousProducts = null;\n    let initialProducts = null;\n    if (!nanoEqual(aggregates, this.state.previous)) {\n      previousProducts = packageProducts(this.state.previous);\n      if (!nanoEqual(this.state.previous, this.state.initial)) {\n        initialProducts = packageProducts(this.state.initial);\n      }\n    }\n    let topMargin = 50;\n    if (window.innerHeight > 1000) {\n      topMargin += 200;\n    }\n    if (previousProducts) {\n      topMargin -= 50;\n      if (initialProducts) {\n        topMargin -= 50;\n      }\n    }\n\n    return (\n      <div style={{ margin: `${topMargin}px 20px` }}>\n        {previousProducts && <p>Current:</p>}\n        <ShowProducts products={products} />\n        {previousProducts && <p>Before:</p>}\n        {previousProducts && (\n          <ShowProducts products={previousProducts} extraClassname=\"before\" />\n        )}\n        {initialProducts && <p>Initial:</p>}\n        {initialProducts && (\n          <ShowProducts products={initialProducts} extraClassname=\"initial\" />\n        )}\n      </div>\n    );\n  }\n}\n\nfunction ShowProducts({ products, extraClassname = \" \" }) {\n  return (\n    <nav className={`level ${extraClassname}`}>\n      {products.map(product => (\n        <div className=\"level-item has-text-centered\" key={product.name}>\n          <div>\n            <p className=\"heading\">{product.name}</p>\n            <p className=\"title\">{product.count.toLocaleString()}</p>\n          </div>\n        </div>\n      ))}\n    </nav>\n  );\n}\n","// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read http://bit.ly/CRA-PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.1/8 is considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n);\n\nexport function register(config) {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(process.env.PUBLIC_URL, window.location.href);\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit http://bit.ly/CRA-PWA'\n          );\n        });\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl, config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        if (installingWorker == null) {\n          return;\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                'New content is available and will be used when all ' +\n                  'tabs for this page are closed. See http://bit.ly/CRA-PWA.'\n              );\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration);\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration);\n              }\n            }\n          }\n        };\n      };\n    })\n    .catch(error => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl, config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl)\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get('content-type');\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf('javascript') === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config);\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App is running in offline mode.'\n      );\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready.then(registration => {\n      registration.unregister();\n    });\n  }\n}\n","import React from \"react\";\nimport ReactDOM from \"react-dom\";\nimport \"./index.scss\";\nimport App from \"./App\";\nimport * as serviceWorker from \"./serviceWorker\";\n\nReactDOM.render(<App />, document.getElementById(\"root\"));\n\n// If you want your app to work offline and load faster, you can change\n// unregister() to register() below. Note this comes with some pitfalls.\n// Learn more about service workers: http://bit.ly/CRA-PWA\nserviceWorker.unregister();\n"],"sourceRoot":""}